# Бот для начисления киберонов

## Инструкция

## Подготовка к использованию


В папке с исполняемым файлом bot.exe должны быть следующие файлы/папки:

   * `google-credentials.json` - файл учетных данных

   * `chromedriver-win64` - папка, внутри которой файл `chromedriver.exe`




## Где это все взять?


* Файл `google-credentials.json` генерируется с помощью google console
* `chromedriver.exe` - скачивается с сайта `hhttps://googlechromelabs.github.io/chrome-for-testing/`



## Драйвер

* заходим на сайт <hhttps://googlechromelabs.github.io/chrome-for-testing/>
* найдите на странице раздел `Stable`
* выберите нужную версию драйвера: `chromedriver - win64`
* скачайте драйвер
* в папке с программой создайте папку (либо из архива можно извлечь) - называем `chromedriver-win64`
* драйвер поместите в папку созданную на предыдущем шаге


## файл учетных данных для доступа к гугл таблицам

Вдыхаем, набираемся терпения и сил. Выдыхаем. Поехали!

* заходим на сайт https://console.cloud.google.com/

* в левом углу открываем меню, выбираем `APIs & Services` -> `Enable APIs and Services`
* сверху нажимаем на `+ Enable APIs and Services`
* выбираем `Google Sheets API` (можно через поиск, можно на странице глазками найти, оно недалеко обычно)
* выбираем `ENABLE`
* так же ищем и выбираем `Google Drive API`
* выбираем `ENABLE`

Самое лёгкое позади! Едем дальше..


После включения этих двух АПИ:

* в левом боковом меню выбираем `Credentials`
* проверяем что возле надписи Google Cloud (сверху слева возле кнопки меню) есть надпись `google sheets` с тремя кружочками
* сверху нажимаем на `+ Create credentials`
* выбираем `Service account`

1й шаг. Тут просто анкета, ничего особенного.

* вводим имя аккаунта
* Service account ID - генерируется автоматически
* Description - оставляем пустым
* нажимаем `Create and continue`


2ой шаг. Надо дать себе права на доступ:
* `Role` - выбираем `Owner`
* нажимаем `Continue`

3й шаг.
* не заполняем, нажимаем `Done`



Ну, пошла жара. Вдохнем еще раз, наберемся сил и терпения. Поехали.

* заходим снова в меню, выбираем `APIs & Services` -> `Credentials`
* в самом низу есть раздел `Service Accounts`
* справа от него есть ссылка `Manage service accounts` - нажимаем, попадаем на сервис аккаунты.
* находим свой созданный, справа нажимаем на три точки, выбираем `manage keys`
* на странице нажимаем `add key` - `create new key`
* выбираем `json`


Cкачается файл:

* переименовываем его в `google-credentials.json`
* помещаем его в папку с исполняемым файлом


Это и есть файл учетных данных. Можно обновить страницу, в списке ключей появится новый, и будет статус `Active`

Всё!




Программа:
* запустили
* видим много полей ввода. заполняем логин и пароль - это учетная запись от <https://kiber-one.club/>. Аккаунт должен быть НЕ менеджера! у менеджера бот не работает (у него другая ссылка)
* ссылка на таблицу - это ссылка на гугл таблицу заполненая по шаблону
* название листа - вводим название листа из гугл таблицы
* путь к файлу учетных данных - путь к `google-credentials.json`
* чтобы не вводить все каждый раз - можно поставить опцию "запомнить". (с ней есть иногда баг, когда меняется путь к файлу учетных данных)
* нажимаем `Начать`


